<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>stumpless: stumpless/target/journald.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">stumpless<span id="projectnumber">&#160;2.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('journald_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">journald.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Journald targets send messages to a systemd journald service.  
<a href="#details">More...</a></p>

<p><a href="journald_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af85586db30336706b57f4a1f55c95ce7" id="r_af85586db30336706b57f4a1f55c95ce7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="config_8h.html#a7300d22c8f17091b752c8280928213ad">STUMPLESS_PUBLIC_FUNCTION</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af85586db30336706b57f4a1f55c95ce7">stumpless_close_journald_target</a> (const struct <a class="el" href="structstumpless__target.html">stumpless_target</a> *target)</td></tr>
<tr class="memdesc:af85586db30336706b57f4a1f55c95ce7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes a journald target.  <br /></td></tr>
<tr class="separator:af85586db30336706b57f4a1f55c95ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43296ed2d21055682b95c21fe0b045b6" id="r_a43296ed2d21055682b95c21fe0b045b6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="config_8h.html#a7300d22c8f17091b752c8280928213ad">STUMPLESS_PUBLIC_FUNCTION</a> size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a43296ed2d21055682b95c21fe0b045b6">stumpless_flatten_element_name</a> (const struct <a class="el" href="structstumpless__entry.html">stumpless_entry</a> *entry, size_t element_index, char *destination, size_t size)</td></tr>
<tr class="memdesc:a43296ed2d21055682b95c21fe0b045b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a journald-compliant name for the element.  <br /></td></tr>
<tr class="separator:a43296ed2d21055682b95c21fe0b045b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c55bdb2cf6c4ed189183d935626af36" id="r_a0c55bdb2cf6c4ed189183d935626af36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="config_8h.html#a7300d22c8f17091b752c8280928213ad">STUMPLESS_PUBLIC_FUNCTION</a> size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c55bdb2cf6c4ed189183d935626af36">stumpless_flatten_param_name</a> (const struct <a class="el" href="structstumpless__entry.html">stumpless_entry</a> *entry, size_t element_index, size_t param_index, char *destination, size_t size)</td></tr>
<tr class="memdesc:a0c55bdb2cf6c4ed189183d935626af36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a name for the param by combining the element and param name.  <br /></td></tr>
<tr class="separator:a0c55bdb2cf6c4ed189183d935626af36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3c0afac3fbe48c257ba64efe35b88ff" id="r_ad3c0afac3fbe48c257ba64efe35b88ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="config_8h.html#a7300d22c8f17091b752c8280928213ad">STUMPLESS_PUBLIC_FUNCTION</a> struct <a class="el" href="structstumpless__target.html">stumpless_target</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3c0afac3fbe48c257ba64efe35b88ff">stumpless_open_journald_target</a> (const char *name)</td></tr>
<tr class="memdesc:ad3c0afac3fbe48c257ba64efe35b88ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens a journald target.  <br /></td></tr>
<tr class="separator:ad3c0afac3fbe48c257ba64efe35b88ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Journald targets send messages to a systemd journald service. </p>
<p>Journald supports structured logging but does not use the same hierarchy as RFC 5424, instead providing a simple key/value pairing. To compensate for this these targets perform a number of transformations to map the elements and params into the flat hierarchy. By default element and param names are converted to uppercase and are joined together using underscores, but this behavior can be customized as needed.</p>
<p>Because RFC 5424 allows most printable ASCII characters while journald only allows letters and numbers, incompatible characters of the generated field name will be replaced with an underscore to comply with journald requirements.</p>
<p><b>Thread Safety: MT-Safe</b> Logging to journald targets is thread safe.</p>
<p><b>Async Signal Safety: AS-Unsafe</b> Logging to journald targets is not signal safe.</p>
<p><b>Async Cancel Safety: AC-Unsafe</b> Logging to journald targets is not async cancellation safe as it relies on sd_journal_sendv which is not documented as such. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af85586db30336706b57f4a1f55c95ce7" name="af85586db30336706b57f4a1f55c95ce7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af85586db30336706b57f4a1f55c95ce7">&#9670;&#160;</a></span>stumpless_close_journald_target()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a7300d22c8f17091b752c8280928213ad">STUMPLESS_PUBLIC_FUNCTION</a> void stumpless_close_journald_target </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structstumpless__target.html">stumpless_target</a> *</td>          <td class="paramname"><span class="paramname"><em>target</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes a journald target. </p>
<p><b>Thread Safety: MT-Unsafe</b> This function is not thread safe as it destroys resources that other threads would use if they tried to reference this target.</p>
<p><b>Async Signal Safety: AS-Unsafe heap</b> This function is not safe to call from signal handlers due to the use of the memory deallocation function to release memory.</p>
<p><b>Async Cancel Safety: AC-Unsafe heap</b> This function is not safe to call from threads that may be asynchronously cancelled, as the memory deallocation function may not be AC-Safe itself.</p>
<dl class="section since"><dt>Since</dt><dd>release v2.1.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>The journald target to close. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="journald_example_8c-example.html#a9">journald_example.c</a>.</dd>
</dl>

</div>
</div>
<a id="a43296ed2d21055682b95c21fe0b045b6" name="a43296ed2d21055682b95c21fe0b045b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43296ed2d21055682b95c21fe0b045b6">&#9670;&#160;</a></span>stumpless_flatten_element_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a7300d22c8f17091b752c8280928213ad">STUMPLESS_PUBLIC_FUNCTION</a> size_t stumpless_flatten_element_name </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structstumpless__entry.html">stumpless_entry</a> *</td>          <td class="paramname"><span class="paramname"><em>entry</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>element_index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>destination</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a journald-compliant name for the element. </p>
<p>All lower case letters are converted to upper case. Characters that are not alphanumeric are replaced with an underscore character. This includes any UTF-8 characters.</p>
<p>If the destination buffer is too small to hold the complete name, then nothing is done. Callers can detect this by comparing the return value to the value provided in the size argument. If the return value is larger, then nothing was done.</p>
<p><b>Thread Safety: MT-Unsafe</b> This function is not thread safe. It reads fields of the entry and element without any synchronization.</p>
<p><b>Async Signal Safety: AS-Safe</b> This function is safe to call from signal handlers.</p>
<p><b>Async Cancel Safety: AC-Safe</b> This function is safe to call from threads that may be asynchronously cancelled.</p>
<dl class="section since"><dt>Since</dt><dd>release v2.1.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>The entry that the param is part of.</td></tr>
    <tr><td class="paramname">element_index</td><td>The index of the element in the entry.</td></tr>
    <tr><td class="paramname">destination</td><td>The buffer to write the name to.</td></tr>
    <tr><td class="paramname">size</td><td>The maximum number of bytes to write to the destination buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes needed to write the complete flattened name, not including a NULL terminating character. If this is greater than size, then it signifies that nothing was done. </dd></dl>

</div>
</div>
<a id="a0c55bdb2cf6c4ed189183d935626af36" name="a0c55bdb2cf6c4ed189183d935626af36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c55bdb2cf6c4ed189183d935626af36">&#9670;&#160;</a></span>stumpless_flatten_param_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a7300d22c8f17091b752c8280928213ad">STUMPLESS_PUBLIC_FUNCTION</a> size_t stumpless_flatten_param_name </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structstumpless__entry.html">stumpless_entry</a> *</td>          <td class="paramname"><span class="paramname"><em>entry</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>element_index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>param_index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>destination</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a name for the param by combining the element and param name. </p>
<p>Both names are converted to all upper case and combined with an underscore character between them.</p>
<p>Characters that are not alphanumeric are replaced with an underscore character. This includes any UTF-8 characters.</p>
<p>If the destination buffer is too small to hold the complete name, then nothing is done. Callers can detect this by comparing the return value to the value provided in the size argument. If the return value is larger, then nothing was done by the call.</p>
<p><b>Thread Safety: MT-Unsafe</b> This function is not thread safe. It reads fields of the entry, element, and param without any synchronization.</p>
<p><b>Async Signal Safety: AS-Safe</b> This function is safe to call from signal handlers.</p>
<p><b>Async Cancel Safety: AC-Safe</b> This function is safe to call from threads that may be asynchronously cancelled.</p>
<dl class="section since"><dt>Since</dt><dd>release v2.1.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>The entry that the param is part of.</td></tr>
    <tr><td class="paramname">element_index</td><td>The index of the element the param is part of.</td></tr>
    <tr><td class="paramname">param_index</td><td>The index of the param within the element.</td></tr>
    <tr><td class="paramname">destination</td><td>The buffer to write the name to.</td></tr>
    <tr><td class="paramname">size</td><td>The maximum number of bytes to write to the destination buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes needed to write the complete flattened name, not including a NULL terminating character. If this is greater than size, then it signifies that nothing was done. </dd></dl>

</div>
</div>
<a id="ad3c0afac3fbe48c257ba64efe35b88ff" name="ad3c0afac3fbe48c257ba64efe35b88ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3c0afac3fbe48c257ba64efe35b88ff">&#9670;&#160;</a></span>stumpless_open_journald_target()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="config_8h.html#a7300d22c8f17091b752c8280928213ad">STUMPLESS_PUBLIC_FUNCTION</a> struct <a class="el" href="structstumpless__target.html">stumpless_target</a> * stumpless_open_journald_target </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens a journald target. </p>
<p>This target will send log entries to the local service.</p>
<p><b>Thread Safety: MT-Safe race:name</b> This function is thread safe, of course assuming that name is not modified by any other threads during execution.</p>
<p><b>Async Signal Safety: AS-Unsafe heap</b> This function is not safe to call from signal handlers due to the use of memory allocation functions.</p>
<p><b>Async Cancel Safety: AC-Unsafe heap</b> This function is not safe to call from threads that may be asynchronously cancelled, as the memory allocation function may not be AC-Safe itself.</p>
<dl class="section since"><dt>Since</dt><dd>release v2.1.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the logging target.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The opened target if no error is encountered. In the event of an error, NULL is returned and an error code is set appropriately. </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="journald_example_8c-example.html#a2">journald_example.c</a>.</dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_ba40c74cc7a9b9ece787ff31120c1693.html">stumpless</a></li><li class="navelem"><a class="el" href="dir_0349ce9a6f8a114f3b3d7011bee1d5bf.html">target</a></li><li class="navelem"><a class="el" href="journald_8h.html">journald.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
