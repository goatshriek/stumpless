# Changelog
All notable changes to stumpless will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/)
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## Unreleased
For a detailed look at the project's future, including planned features and bug
fixes, check out the
[roadmap](https://github.com/goatshriek/stumpless/blob/master/docs/roadmap.md).

## [2.0.0] - 2020-12-27
### Added
 - Localization framework for error messages and other library strings, and
   localizations for:
    * French (fr-FR :fr:)
    * German (de-DE :de:)
    * Italian (it-IT :it:)
    * Slovak (sk-SK :slovakia:)
    * Swedish (sv-SE :sweden:)
 - Thread safety for all functionality.
 - The following functions:
    * `stumpless_free_thread`
    * `stumpless_get_element_count`
    * `stumpless_get_target_name`
    * `stumpless_get_target_default_app_name`
    * `stumpless_get_target_default_msgid`
    * `stumpless_param_to_string`
    * `stumpless_read_buffer`
  - The following C++ function bindings:
    * `Entry.GetAppName`
    * `Entry.GetMessage`
    * `Entry.GetMsgid`
    * `Version.Compare`

### Changed
 - C++ namespace from `stumplesscpp` to `stumpless`.
 - Including `stumpless/config.h` no longer defines `WIN32_LEAN_AND_MEAN`.
 - Facilities, options, and severities are now only available in the
   `stumpless/facility.h`, `stumpless/option.h`, and `stumpless/severity.h`
   headers, respectively.
 - Functions that return strings now require the caller to free the string
   when it is no longer needed. Prior to this version these strings pointed
   to internal character buffers that could not be modified. The functions
   affected by this are:
    * `stumpless_get_element_name`
    * `stumpless_get_entry_app_name`
    * `stumpless_get_entry_message`
    * `stumpless_get_entry_msgid`
    * `stumpless_get_entry_param_value_by_index`
    * `stumpless_get_entry_param_value_by_name`
    * `stumpless_get_param_name`
    * `stumpless_get_param_name_by_index`
    * `stumpless_get_param_value`
    * `stumpless_get_param_value_by_index`
    * `stumpless_get_param_value_by_name`
 - The underlying buffer in buffer targets should no longer be read manually,
   but should instead use the new `stumpless_read_buffer` function as the only
   way to read messages.
 - All target open functions no longer require an options or default facility
   parameter, resulting in much more concise code. If either of these fields
   need to be adjusted on a target, use the `stumpless_set_option` and
   `stumpless_set_default_facility` functions after the target has been
   created.
 - Facilities and severities are now `enum`s instead of preprocessor symbols.

### Deprecated
 - `stumpless_destroy_entry` has been deprecated in favor of the more
   descriptive and deliberate `stumpless_destroy_entry_and_contents` and
   `stumpless_destroy_entry_only` functions in order to avoid unintentional
   memory leaks and use-after-free mistakes.
 - `stumpless_destroy_element` has been deprecated in favor of the more
   descriptive and deliberate `stumpless_destroy_element_and_contents` and
   `stumpless_destroy_element_only` functions in order to avoid
   unintentional memory leaks and use-after-free mistakes.

### Fixed
 - Memory leak in opening of network targets on systems using `sys/socket.h`
   for network services.

### Removed
 - `stumpless` and `vstumpless` functions (use `stump` and `vstump` instead).
 - `STUMPLESS_SEVERITY_WARN` symbol.

## [1.6.0] - 2020-07-16
### Added
 - A number of new functions for working with entries, elements, and params.
 - A rollup header, `stumpless.hpp`, for the C++ library to make use easier.
 - Logging functions that can be removed at compile time.

### Fixed
 - Added missing DLL exports of C++ library in standard Visual Studio builds.
 - Local socket names are generated using mkstemp instead of using a static
   counter ([issue #54](https://github.com/goatshriek/stumpless/issues/54)]).
 - The current target is not left pointing at an invalid target structure
   after the current target is closed
   ([issue #52](https://github.com/goatshriek/stumpless/issues/52)).

## [1.5.0] - 2020-05-19
### Added
 - `stumpless_version_to_string` function.
 - Header check enforcement in CI pipeline.
 - C++ library bindings generated by Wrapture.

### Fixed
 - Several portability issues:
   - Build failure in MinGW and Cygwin
   - Conflicting header inclusions
   - Missing headers
   - Missed code in configuration-specific source files
   - Missing error checks

## [1.4.0] - 2019-03-09
### Added
 - Format specifier support for messages and entries.
 - Generic stumpless_close_target function.
 - Example and documentation of file targets.
 - Example and documentation of socket targets.
 - Functions that can replace syslog and vsyslog (stumplog and vstumplog).
 - Default targets specific to the platform.

### Fixed
 - Memory leak where error structures are not freed by stumpless_free_all.
 - Missing error generation for socket logging.

### Changed
 - Network examples are no longer run by the examples build target.

## [1.3.1] - 2019-02-15
### Fixed
 - Code duplication in network target code.

## [1.3.0] - 2019-02-14
### Added
 - Install target and documentation.
 - Memory leak controlled with stumpless_free_all function.
 - Vision statement.
 - STUMPLESS_OPTION_NONE for code readability.
 - stumpless_perror function.
 - Network target capability.

### Fixed
 - Various memory leaks.

## [1.2.0] - 2018-11-09
### Added
 - Increased coverage on object cache.
 - Support for fractional timestamps.
 - File target capability.
 - Windows Event Log target capability.
 - Doxygen documentation support.
 - Tests for unsupported targets.
 - Stream target capability.

### Fixed
 - Use of unsafe fopen when fopen_s is available.
 - Use of unsafe gmtime function when gmtime_r is available.
 - Safely convert from size_t to int types.
 - Inclusion of RFC 5424 test sources in multiple executables, using an object
   library instead.

## [1.1.2] - 2018-10-04
### Fixed
 - Specify googletest release 1.8.1 to fix broken builds.

## [1.1.1] - 2018-08-28
### Added
 - Add SonarCloud quality gate badge to README.

## [1.1.0] - 2018-08-27
### Added
 - Benchmark tests measure the amount of memory allocated.
 - Add `stumpless_set_entry_message` function.
 - Integration with SonarCloud for analysis.

### Fixed
 - Removed versions prior to 1.0.0 to match repository history.
 - Benchmark tests now function properly.
 - Memory efficiency improved significantly.

## [1.0.0] - 2018-07-28
### Added
 - Add socket target capability.
 - Add buffer target capability.
 - Add Travis CI integration.
 - Add AppVeyor integration.
 - Add Google Test suites.
 - Add Google Benchmark capability.
